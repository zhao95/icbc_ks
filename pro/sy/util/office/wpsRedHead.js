/***	使用wps套红头的程序**/function WpsRedHead(){	this.wpsApp = null;	this.targetDoc = null;	this.tempDoc = null;	this.downLoadFileName = null;	this.DownloadURL = null;		this.createWord=function(downUrl,TempDownloadURL,tempFileName){		this.downLoadFileName = tempFileName;		this.DownloadURL =  downUrl;		try {			wpsApp = new ActiveXObject("Wps.Application");			wpsApp.Visible = false; //设置word打开后可见;			tempDoc  = wpsApp.Documents.Open(TempDownloadURL);//打开word模板		} catch(exception) {			alert("createWord:" + exception.message);			return false;		}				return true;	};			//替换正文	this.replaceText=function(){		//downLoadFileName需要取值		if(this.downLoadFileName.length > 0 ){			this.replaceContent();		}    };		this.replaceContent = function(){		try{			targetDoc = wpsApp.Documents.Open(this.DownloadURL);			targetDoc.acceptAllRevisions();			tempDoc.Activate();			tempDoc.Content.Select();			wpsApp.selection.Find.forward = true;			wpsApp.selection.Find.ClearFormatting();			wpsApp.selection.Find.MatchWholeWord = true;			wpsApp.selection.Find.MatchCase = false;			wpsApp.selection.Find.Wrap = 1;			//wpsApp.selection.Find.Execute("#text#",false,true, undefined, undefined, undefined,undefined, undefined, undefined, undefined, 0);			wpsApp.selection.Find.Execute("#text#",false,false, false, false, false,false, 1, true, "", 0);									if(wpsApp.selection.Find.Found){				this.copyContent(targetDoc,tempDoc);			}else{				/*				var shapeCount = tempDoc.Shapes.count;				for(var j = 1; j < shapeCount; j++){					sharpName = tempDoc.Shapes(j).Name().substring(0,8);					if(sharpName == "Text Box"){						tempDoc.Shapes.SelectAll();						wpsApp.selection.Find.ClearFormatting();						wpsApp.selection.Find.Replacement.ClearFormatting();						wpsApp.selection.Find.Text = "#text#";						wpsApp.selection.Find.Execute();						if(wpsApp.selection.Find.Found){							this.copyContent(targetDoc,tempDoc);						}					}				}*/			}						wpsApp.NormalTemplate.Saved = true;			//targetDoc.Close(); 			//wdDoNotSaveChanges;						//targetDoc = null;		}catch(exception){			wpsApp.NormalTemplate.Saved = false;			alert("replaceContent:" + exception.message);		}	};		this.copyContent = function(srcWordDoc,dstWordDoc){		var templateFont;		if(this.ifChangeFont){			templateFont = dstWordDoc.Application.selection.Font.Duplicate;		}		srcWordDoc.Activate();		if(this.ifChangeFont){			srcWordDoc.Application.selection.Font = templateFont;		}				//替换源文件的字体，并复制		srcWordDoc.Activate();		srcWordDoc.Content.Select();		if(this.ifChangeFont){			srcWordDoc.Application.selection.Font.size = templateFont.size			srcWordDoc.Application.selection.Font.Bold = templateFont.Bold			srcWordDoc.Application.selection.Font.Name = templateFont.Name			srcWordDoc.Application.selection.Font.Spacing = templateFont.Spacing			srcWordDoc.Application.selection.Font.Color = templateFont.Color		}					srcWordDoc.Application.selection.Copy();		dstWordDoc.Activate();		dstWordDoc.Application.selection.Paste();	};		//替换marker	this.repleaceMarker = function(source,dest){		try{			tempDoc.Content.Select();			this.replaceSelect(source,dest);			tempDoc.Shapes.SelectAll();			this.replaceSelect(source,dest);			var shapeCount = tempDoc.Shapes.count;			for(var j = 1; j <= shapeCount; j++){				if(tempDoc.Shapes.item(j).type == 17){ //ksotextbox					tempDoc.Shapes(j).Select();					this.replaceSelect(source,dest);				}			}		}catch(exception){			alert("repleaceMarker:" + exception.message);		}	};		this.replaceSelect = function(source,dest){		wpsApp.selection.Find.ClearFormatting();		wpsApp.selection.Find.Replacement.ClearFormatting();		wpsApp.selection.Find.Execute(source, false, false, false, false, false, true, 1, true, dest, 2);	};		this.clearResource = function(){		try{			if(targetDoc != null) {				targetDoc.save();				targetDoc.Close();				targetDoc = null;			}		}catch(e){				}				try{			if(tempDoc != null) {				tempDoc.save();				tempDoc.Close();				tempDoc = null;			}		}catch(e){				}				try{			if(wpsApp != null){				wpsApp.Quit();				wpsApp = null;			}		}catch(e){				}				this.downLoadFileName = null;		this.DownloadURL = null;	}}