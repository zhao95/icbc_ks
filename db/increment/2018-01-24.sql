alter table TS_KCGL drop column KC_XM_ID;
alter table TS_KCGL drop column KC_XM_NAME;
alter table ts_bmsh_rule add column RULE_CY VARCHAR(400) NOT NULL;
alter table ts_bmsh_rule add column RULE_MAST VARCHAR(400) NOT NULL;
UPDATE `ts_xmgl_bm_kslbk` SET `KSLBK_ALIKE_DIFF`=NULL, `KSLBK_TYPE_LEVEL`='2', `KSLBK_ID`='155024vTq17xpi3uQBGu', `KSLBK_NAME`='专业类', `KSLBK_XL`='信贷', `KSLBK_MK`='C类', `KSLBK_TYPE`='1', `S_USER`='0000768887', `S_TDEPT`='0010100026', `S_ODEPT`='0010100000', `S_MTIME`='2017-12-11 16:10:08:556', `S_FLAG`='1', `S_DEPT`='0010100890', `S_CMPY`='icbc', `S_ATIME`='2017-12-11 16:10:08:556', `KSLBK_PID`='0lb0P34lJ4o9yVuDJp5a', `KSLBK_LEVEL`='4', `CODE_PATH`='0x5AAcHJu19WWOJTrAbF^375su6PYtdoo0KmBKSRO^0lb0P34lJ4o9yVuDJp5a^155024vTq17xpi3uQBGu^', `KSLBK_IDVALUE`='c类', `KSLBK_MKCODE`='02300201300301', `KSLBK_TIME`='60', `KSLBK_CODE`='023002', `KSLBK_XL_CODE`='A000000000000000013', `KSLBK_TYPE_NAME`='无层级' WHERE (`KSLBK_ID`='155024vTq17xpi3uQBGu');

create or replace view ts_kcgl_v as 
select `t`.`KC_ID` AS `kc_id`,`t`.`KC_TYPE` AS `KC_TYPE`,`t`.`KC_CODE` AS `kc_code`,`t`.`SERV_ID` AS `serv_id`,`t`.`GROUP_ID` AS `GROUP_ID`,`t`.`COPY_ID` AS `copy_id`,`t`.`KC_NAME` AS `kc_name`,`t`.`KC_ADDRESS` AS `kc_address`,`t`.`KC_ODEPTNAME` AS `kc_odeptname`,`t`.`KC_ODEPTCODE` AS `kc_odeptcode`,`t`.`KC_LEVEL` AS `kc_level`,`t`.`KC_LXDH` AS `kc_lxdh`,`t`.`KC_CREATOR` AS `kc_creator`,`t`.`KC_MAX` AS `kc_max`,`t`.`KC_GOOD` AS `kc_good`,`t`.`KC_USE_NUM` AS `kc_use_num`,`t`.`KC_IP1` AS `kc_ip1`,`t`.`KC_IP2` AS `kc_ip2`,`t`.`KC_SCORE` AS `kc_score`,`t`.`KC_STATE` AS `kc_state`,(case when (`t`.`KC_STATE` = 3) then 0 when ((select count(`u`.`UPDATE_ID`) from `ts_kcgl_update` `u` where ((`u`.`KC_ID` = `t`.`KC_ID`) and (`u`.`KC_COMMIT` = 1) and (`u`.`UPDATE_AGREE` = 0))) > 0) then 1 else 2 end) AS `ORDERCOL`,`t`.`CTLG_PCODE` AS `CTLG_PCODE`,`t`.`S_USER` AS `s_user`,`t`.`S_TDEPT` AS `s_tdept`,`t`.`S_ODEPT` AS `s_odept`,`t`.`S_MTIME` AS `s_mtime`,`t`.`S_FLAG` AS `s_flag`,`t`.`S_DEPT` AS `s_dept`,`t`.`S_CMPY` AS `s_cmpy`,`t`.`S_ATIME` AS `s_atime`,`t`.`KC_STATE2` AS `KC_STATE2`,(select `a`.`DEPT_LEVEL` from `sy_org_dept` `a` where (`a`.`DEPT_CODE` = `t`.`S_ODEPT`)) AS `odept_level`,(select `a`.`CODE_PATH` from `sy_org_dept` `a` where (`a`.`DEPT_CODE` = `t`.`S_ODEPT`)) AS `odept_path`,group_concat(`g`.`GLY_NAME` separator ',') AS `gly_name` from (`ts_kcgl` `t` left join `ts_kcgl_gly` `g` on((`t`.`KC_ID` = `g`.`KC_ID`))) group by `t`.`KC_ID`